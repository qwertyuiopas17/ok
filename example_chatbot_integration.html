<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sehat Sahara Enhanced Chatbot Integration Example</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: #007bff;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 24px;
        }

        .header p {
            margin: 8px 0 0 0;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
        }

        .section h3 {
            color: #007bff;
            margin-top: 0;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .feature-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }

        .feature-item h4 {
            margin: 0 0 8px 0;
            color: #007bff;
        }

        .feature-item p {
            margin: 0;
            font-size: 14px;
            color: #666;
        }

        .demo-section {
            background: #e3f2fd;
            border: 1px solid #2196f3;
        }

        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }

        .button:hover {
            background: #0056b3;
        }

        .button.secondary {
            background: #6c757d;
        }

        .button.danger {
            background: #dc3545;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 6px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .notification.info { background: #007bff; }
        .notification.success { background: #28a745; }
        .notification.error { background: #dc3545; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .chat-demo {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            height: 300px;
            overflow-y: auto;
            padding: 15px;
            background: #fafafa;
            margin: 15px 0;
        }

        .message {
            margin: 8px 0;
            padding: 12px;
            border-radius: 8px;
            max-width: 80%;
        }

        .user-message {
            background: #007bff;
            color: white;
            margin-left: auto;
            text-align: right;
        }

        .bot-message {
            background: #e3f2fd;
            margin-right: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Enhanced Sehat Sahara Chatbot</h1>
            <p>Interactive Buttons, Progress Tracking & Smart Follow-up</p>
        </div>

        <div class="content">
            <div class="section">
                <h3>‚úÖ What's New in Enhanced Sehat Sahara</h3>

                <div class="feature-list">
                    <div class="feature-item">
                        <h4>üéØ Interactive Buttons</h4>
                        <p>Context-aware buttons appear when users need to book appointments, scan medicines, or view prescriptions</p>
                    </div>
                    <div class="feature-item">
                        <h4>üìä Progress Tracking</h4>
                        <p>Remembers appointment status, prescription history, and user journey across sessions</p>
                    </div>
                    <div class="feature-item">
                        <h4>üí¨ Post-Appointment Care</h4>
                        <p>Follows up after appointments, provides prescription summaries, and offers continued support</p>
                    </div>
                    <div class="feature-item">
                        <h4>üõ°Ô∏è Enhanced Safety</h4>
                        <p>Maintains strict NO MEDICAL ADVICE policy while providing better user guidance</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>üîß Backend Updates Made</h3>

                <h4>1. Enhanced Conversation Memory</h4>
                <div class="code-block">
// Added progress tracking fields
appointment_status: Dict[str, Any]
prescription_summary: Dict[str, Any]
post_appointment_feedback_pending: bool
interactive_buttons: List[str]
                </div>

                <h4>2. New API Endpoints</h4>
                <div class="code-block">
POST /v1/button-action          # Handle button clicks
POST /v1/user-progress          # Get user progress state
POST /v1/post-appointment-feedback  # Handle follow-up responses
POST /v1/prescription-summary   # Get prescription summaries
                </div>

                <h4>3. Enhanced Response Format</h4>
                <div class="code-block">
{
  "language": "hi",
  "response": "‡§ï‡•à‡§∏‡§æ ‡§≤‡§ó ‡§∞‡§π‡§æ ‡§π‡•à ‡§Ö‡§¨?",
  "action": "CONTINUE_FOLLOWUP",
  "parameters": {},
  "interactive_buttons": [
    {
      "type": "prescription_view",
      "text": "‡§™‡•ç‡§∞‡§ø‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç",
      "action": "SHOW_PRESCRIPTION_SUMMARY",
      "style": "secondary"
    }
  ]
}
                </div>
            </div>

            <div class="section demo-section">
                <h3>üéÆ Interactive Demo</h3>
                <p>Click the buttons below to see how the enhanced chatbot responds:</p>

                <button class="button" onclick="simulateUserMessage('‡§Æ‡•Å‡§ù‡•á ‡§¨‡•Å‡§ñ‡§æ‡§∞ ‡§π‡•à')">Send: "‡§Æ‡•Å‡§ù‡•á ‡§¨‡•Å‡§ñ‡§æ‡§∞ ‡§π‡•à"</button>
                <button class="button" onclick="simulateUserMessage('appointment book karni hai')">Send: "appointment book karni hai"</button>
                <button class="button" onclick="simulateUserMessage('feeling better after appointment')">Send: "feeling better after appointment"</button>
                <button class="button" onclick="simulateUserMessage('what did doctor prescribe')">Send: "what did doctor prescribe"</button>

                <div id="demo-output" class="chat-demo">
                    <div class="message bot-message">üëã Welcome to Enhanced Sehat Sahara! I can help you with appointments, prescriptions, and health guidance.</div>
                </div>

                <div id="buttons-container"></div>
            </div>

            <div class="section">
                <h3>üì± Frontend Integration Guide</h3>

                <h4>1. Include the Button Handler</h4>
                <div class="code-block">
<script src="frontend_button_handler.js"></script>
<script>
    const buttonHandler = new SehatSaharaButtonHandler('chat-container');
</script>
                </div>

                <h4>2. Handle Chatbot Responses</h4>
                <div class="code-block">
// When you receive a response from /v1/predict
buttonHandler.handleChatbotResponse(response);

// The handler will:
// - Display the text response
// - Show interactive buttons if present
// - Handle button click navigation
                </div>

                <h4>3. Button Click Handling</h4>
                <div class="code-block">
// Buttons automatically handle navigation to:
// - Appointment booking page
// - Medicine scanner (camera)
// - Prescription viewer
// - Emergency calling (108)
                </div>
            </div>

            <div class="section">
                <h3>üöÄ API Integration Examples</h3>

                <h4>Button Action Handling</h4>
                <div class="code-block">
// Frontend sends button click to backend
fetch('/v1/button-action', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        userId: currentUserId,
        buttonType: 'appointment_booking',
        buttonAction: 'NAVIGATE_TO_APPOINTMENT_BOOKING'
    })
});
                </div>

                <h4>User Progress Tracking</h4>
                <div class="code-block">
// Get user's current progress and state
fetch('/v1/user-progress', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ userId: currentUserId })
})
.then(response => response.json())
.then(data => {
    // Check if buttons should be shown
    if (data.progress.interactive_buttons.appointment) {
        showAppointmentButton();
    }
});
                </div>
            </div>
        </div>
    </div>

    <script>
        // Demo functionality
        function simulateUserMessage(message) {
            // Add user message to demo
            const demoOutput = document.getElementById('demo-output');
            const userMessage = document.createElement('div');
            userMessage.className = 'message user-message';
            userMessage.textContent = message;
            demoOutput.appendChild(userMessage);

            // Simulate bot response based on message
            setTimeout(() => {
                const botResponse = getSimulatedResponse(message);
                const botMessage = document.createElement('div');
                botMessage.className = 'message bot-message';
                botMessage.textContent = botResponse.response;
                demoOutput.appendChild(botMessage);

                // Show buttons if present
                if (botResponse.interactive_buttons) {
                    showDemoButtons(botResponse.interactive_buttons);
                }

                demoOutput.scrollTop = demoOutput.scrollHeight;
            }, 1000);
        }

        function getSimulatedResponse(message) {
            // Simulate different responses based on message content
            if (message.includes('‡§¨‡•Å‡§ñ‡§æ‡§∞') || message.includes('fever')) {
                return {
                    response: "‡§Ü‡§™‡§ï‡•ã ‡§ï‡•ç‡§Ø‡§æ ‡§™‡§∞‡•á‡§∂‡§æ‡§®‡•Ä ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à? ‡§ï‡§¨ ‡§∏‡•á ‡§ê‡§∏‡§æ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à?",
                    action: "CONTINUE_SYMPTOM_CHECK",
                    interactive_buttons: [
                        {
                            type: "appointment_booking",
                            text: "‡§Ö‡§™‡•â‡§á‡§Ç‡§ü‡§Æ‡•á‡§Ç‡§ü ‡§¨‡•Å‡§ï ‡§ï‡§∞‡•á‡§Ç",
                            action: "NAVIGATE_TO_APPOINTMENT_BOOKING",
                            style: "primary"
                        }
                    ]
                };
            } else if (message.includes('appointment')) {
                return {
                    response: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä appointment ‡§¨‡•Å‡§ï ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§ï‡§ø‡§∏ ‡§§‡§∞‡§π ‡§ï‡•á ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ö‡§æ‡§π‡§ø‡§è?",
                    action: "Maps_TO_APPOINTMENT_BOOKING",
                    interactive_buttons: [
                        {
                            type: "appointment_booking",
                            text: "‡§Ö‡§™‡•â‡§á‡§Ç‡§ü‡§Æ‡•á‡§Ç‡§ü ‡§¨‡•Å‡§ï ‡§ï‡§∞‡•á‡§Ç",
                            action: "NAVIGATE_TO_APPOINTMENT_BOOKING",
                            style: "primary"
                        }
                    ]
                };
            } else if (message.includes('feeling better') || message.includes('appointment')) {
                return {
                    response: "‡§Ø‡§π ‡§∏‡•Å‡§®‡§ï‡§∞ ‡§ñ‡•Å‡§∂‡•Ä ‡§π‡•Å‡§à ‡§ï‡§ø ‡§Ü‡§™ ‡§¨‡•á‡§π‡§§‡§∞ ‡§Æ‡§π‡§∏‡•Ç‡§∏ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç! ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡•Ä ‡§∏‡§≤‡§æ‡§π ‡§´‡•â‡§≤‡•ã ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç?",
                    action: "CONTINUE_FOLLOWUP",
                    interactive_buttons: [
                        {
                            type: "prescription_view",
                            text: "‡§™‡•ç‡§∞‡§ø‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç",
                            action: "SHOW_PRESCRIPTION_SUMMARY",
                            style: "secondary"
                        }
                    ]
                };
            } else if (message.includes('prescribe') || message.includes('‡§¶‡§µ‡§æ')) {
                return {
                    response: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§Ü‡§™‡§ï‡•Ä ‡§¶‡§µ‡§æ‡§á‡§Ø‡•ã‡§Ç ‡§ï‡§æ summary ‡§¶‡§ø‡§ñ‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§ ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§®‡•á ‡§ï‡•ç‡§Ø‡§æ ‡§≤‡§ø‡§ñ‡§æ ‡§π‡•à?",
                    action: "SHOW_PRESCRIPTION_SUMMARY",
                    interactive_buttons: [
                        {
                            type: "prescription_view",
                            text: "‡§™‡•ç‡§∞‡§ø‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç",
                            action: "SHOW_PRESCRIPTION_SUMMARY",
                            style: "secondary"
                        }
                    ]
                };
            }

            return {
                response: "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•Ç‡§Ç‡•§ ‡§Ü‡§™ ‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡§¶‡§¶ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?",
                action: "SHOW_APP_FEATURES",
                interactive_buttons: []
            };
        }

        function showDemoButtons(buttons) {
            const buttonsContainer = document.getElementById('buttons-container');
            buttonsContainer.innerHTML = '';

            if (buttons.length === 0) return;

            const container = document.createElement('div');
            container.style.cssText = `
                display: flex;
                gap: 10px;
                margin-top: 10px;
                flex-wrap: wrap;
            `;

            buttons.forEach(button => {
                const btn = document.createElement('button');
                btn.textContent = button.text;
                btn.className = `button ${button.style === 'primary' ? '' : button.style === 'secondary' ? 'secondary' : 'danger'}`;
                btn.onclick = () => {
                    showNotification(`Button clicked: ${button.text}`, 'info');
                };
                container.appendChild(btn);
            });

            buttonsContainer.appendChild(container);
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // Initialize demo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Enhanced Sehat Sahara Chatbot Demo Loaded');
        });
    </script>
</body>
</html>